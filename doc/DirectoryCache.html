<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: DirectoryCache</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: DirectoryCache</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>DirectoryCache<span class="signature">(conf)</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>DirectoryCache</p>
<p>The aim of this class is to take care of loading files from a directory
and backing them up at intervals.</p>
<p>This class has an option to use or not use the caching version of the file system oeprations.</p>
<p>This class will start the backup process if the backup interval and the directory have been specified.</p>
<p>This class does not call the <code>load_directory</code> method upon construction.
The application must call it. In particular, it must call the class <code>load_directory</code>
method with an item injector, a function that puts elements into the object list
provided in the configuration. This class does not operate on the list directly,
it calls the injector.</p>
<p>Fields of Conf:</p>
<ul>
<li>default_directory</li>
<li>noisy              -- whether to print log messages or not</li>
<li>crash_cant_load    -- turns off reloading after a crash</li>
<li>file_namer         -- a function that names files on behalf of the application per object stored</li>
<li>object_list        -- reference to a list that another part of an application will grow and shrink;
This class just writes the objects to disk.</li>
<li>use_caching        -- off by default. If on, then the caching version of the file operation is used</li>
<li>backup_interval    -- time to wait between backups in miliseconds</li>
</ul></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="DirectoryCache"><span class="type-signature"></span>new DirectoryCache<span class="signature">(conf)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>DirectoryCache.constructor</p>
<p>The constructor has just one parameter. See &quot;Fields of Conf&quot;.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>conf</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="directory_caches.js.html">directory_caches.js</a>, <a href="directory_caches.js.html#line34">line 34</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="backup_to_directory"><span class="type-signature">(async) </span>backup_to_directory<span class="signature">(file_namer, base_dir, list, ce_flags)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>backup_to_directory</p>
<p>The applicaetion may call this method directly, or the application may configure
the interval function, which calls this method.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>file_namer</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>given an object, this method should return a string for a file name</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>base_dir</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>this base dir can override the configured one or be set to use it.</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>list</code></td>
            

            <td class="type">
            
                
<span class="param-type">Iterable</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>list is an iterable that provides access to writable objects</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ce_flags</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>see node.js file system documentation for flags to use in writing to a file.</li>
</ul></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="directory_caches.js.html">directory_caches.js</a>, <a href="directory_caches.js.html#line135">line 135</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="get_fos"><span class="type-signature"></span>get_fos<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>get_fos</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="directory_caches.js.html">directory_caches.js</a>, <a href="directory_caches.js.html#line158">line 158</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>object -- the file operation object this directory cache is using</p>
</div>



    





        
            

    

    
    <h4 class="name" id="load_directory"><span class="type-signature">(async) </span>load_directory<span class="signature">(dpath, item_injector, base_dir, after_action)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>load_directory</p>
<p>The directory consists of a number of files each containing one JSON object.
The most likely case will be that the objects are fairly large. Or, there will be many small
files. It is possible that the item injector takes an array of objects as well.</p>
<p>The <code>base_dir</code> is the directory (abolute or relative to the application cwd).
This method can override the <code>base_dir</code> set in the configuration. Otherwise, it can be left
empty or string 'default' can be passed, where this method reserves the string 'default' to
select the configured <code>base_dir</code>.</p>
<p><code>after_action</code> is some code supplied by the application and is optional.
It can take in an array of errors if the application wants to process errors
that may occur in loading files. Otherwise, no information is passed on to the method.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>dpath</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>a path relative to the base directory</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>item_injector</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>a method taking one object</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>base_dir</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>this base dir can override the configured one or be set to use it.</li>
</ul></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>after_action</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>a call back.</li>
</ul></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="directory_caches.js.html">directory_caches.js</a>, <a href="directory_caches.js.html#line90">line 90</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="start"><span class="type-signature"></span>start<span class="signature">(b_interval)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>start</p>
<p>Calls setInterval with a thunk wrapping <code>backup_to_directory</code></p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>b_interval</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last"><ul>
<li>integer required for setInterval (<strong>b</strong>ackup interval)</li>
</ul></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="directory_caches.js.html">directory_caches.js</a>, <a href="directory_caches.js.html#line180">line 180</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="stop"><span class="type-signature"></span>stop<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>stop</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="directory_caches.js.html">directory_caches.js</a>, <a href="directory_caches.js.html#line166">line 166</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="DefaultCacheTable.html">DefaultCacheTable</a></li><li><a href="DirectoryCache.html">DirectoryCache</a></li><li><a href="FileOperations.html">FileOperations</a></li><li><a href="FileOperationsCache.html">FileOperationsCache</a></li><li><a href="FsExtra.html">FsExtra</a></li><li><a href="PathManager.html">PathManager</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Wed Oct 22 2025 15:58:34 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>