<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>lib/path_extension.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Overview</a></h2><h2><a href="https://github.com/copious-world/extra-file-class" target="_blank" class="menu-item" id="repository" >Github repo</a></h2><h2><a href="https://www.npmjs.com/package/extra-file-class" target="_blank" class="menu-item" id="package" >Npm package</a></h2><h3>Classes</h3>
                        <ul id="classes-ul-overflow" class="menu-contained-nav" ><li><a href="DefaultCacheTable.html">DefaultCacheTable</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#add_dir">add_dir</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#add_file">add_file</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#add_file_to_dir">add_file_to_dir</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#all_changed_files">all_changed_files</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#clone_file">clone_file</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#contains">contains</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#contains_file">contains_file</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#file_data">file_data</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#init">init</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#mark_changed">mark_changed</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#remove_dir">remove_dir</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#remove_file">remove_file</a></li><li data-type='method' style='display: none;'><a href="DefaultCacheTable.html#set_file_data">set_file_data</a></li></ul></li><li><a href="DirectoryCache.html">DirectoryCache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DirectoryCache.html#backup_to_directory">backup_to_directory</a></li><li data-type='method' style='display: none;'><a href="DirectoryCache.html#get_fos">get_fos</a></li><li data-type='method' style='display: none;'><a href="DirectoryCache.html#load_directory">load_directory</a></li><li data-type='method' style='display: none;'><a href="DirectoryCache.html#start">start</a></li><li data-type='method' style='display: none;'><a href="DirectoryCache.html#stop">stop</a></li></ul></li><li><a href="ExtraFileClass.FileOperations.html">ExtraFileClass.FileOperations</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#data_reader">data_reader</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#different_drive">different_drive</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#different_drive_sync">different_drive_sync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#dir_maker">dir_maker</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#dir_reader">dir_reader</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#dir_remover">dir_remover</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#ensure_directories">ensure_directories</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#ensured_file_copier">ensured_file_copier</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#ensured_file_mover">ensured_file_mover</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#exists">exists</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#file_copier">file_copier</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#file_mover">file_mover</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#file_remover">file_remover</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#is_dir">is_dir</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#is_dirSync">is_dirSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#is_file">is_file</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#is_fileSync">is_fileSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#json_data_reader">json_data_reader</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#load_data_at_path">load_data_at_path</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#load_json_data_at_path">load_json_data_at_path</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#output_append_string">output_append_string</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#output_json">output_json</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#output_string">output_string</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#watch">watch</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#write_append_string">write_append_string</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#write_out_json">write_out_json</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FileOperations.html#write_out_string">write_out_string</a></li></ul></li><li><a href="ExtraFileClass.FsExtra.html">ExtraFileClass.FsExtra</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#areIdentical">areIdentical</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#copy">copy</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#copySync">copySync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#createFile">createFile</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#createFileSync">createFileSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#createLink">createLink</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#createLinkSync">createLinkSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#createSymlink">createSymlink</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#createSymlinkSync">createSymlinkSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#emptyDir">emptyDir</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#emptyDirSync">emptyDirSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#ensureDirSync">ensureDirSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#getStats">getStats</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#getStatsSync">getStatsSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#isSrcSubdir">isSrcSubdir</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#makeDir">makeDir</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#makeDirSync">makeDirSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#mkdirpSync">mkdirpSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#mkdirs">mkdirs</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#move">move</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#moveSync">moveSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#outputFile">outputFile</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#outputFileSync">outputFileSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#outputJson">outputJson</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#outputJsonSync">outputJsonSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#pathExists">pathExists</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#readJson">readJson</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#readJsonSync">readJsonSync</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#remove">remove</a></li><li data-type='method' style='display: none;'><a href="ExtraFileClass.FsExtra.html#removeSync">removeSync</a></li></ul></li><li><a href="FileOperationsCache.html">FileOperationsCache</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#_file_entry_maker">_file_entry_maker</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#_file_remover_cache">_file_remover_cache</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#dir_maker">dir_maker</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#dir_remover">dir_remover</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#ensure_directories">ensure_directories</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#exists">exists</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#file_copier">file_copier</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#file_remover">file_remover</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#init">init</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#load_json_data_at_path">load_json_data_at_path</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#startup_sync">startup_sync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#stop_sync">stop_sync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#synch_files">synch_files</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#update_at_path">update_at_path</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#write_out_json">write_out_json</a></li><li data-type='method' style='display: none;'><a href="FileOperationsCache.html#write_out_string">write_out_string</a></li></ul></li><li><a href="FileOperationsWeb.html">FileOperationsWeb</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#add_file">add_file</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#check_user_dir_support">check_user_dir_support</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#copy">copy</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#createFile">createFile</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#data_reader">data_reader</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#different_drive">different_drive</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#dir_locus">dir_locus</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#dir_maker">dir_maker</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#dir_reader">dir_reader</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#dir_remover">dir_remover</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#emptyDir">emptyDir</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#ensure_directories">ensure_directories</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#ensured_file_copier">ensured_file_copier</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#ensured_file_mover">ensured_file_mover</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#exists">exists</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#exists_dir">exists_dir</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#file_copier">file_copier</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#file_locus">file_locus</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#file_maker">file_maker</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#file_mover">file_mover</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#file_remover">file_remover</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#get_parent_dirs">get_parent_dirs</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#in_web_worker">in_web_worker</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#interactive_file_download">interactive_file_download</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#interactive_file_retrieval">interactive_file_retrieval</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#interactive_permission">interactive_permission</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#is_dir">is_dir</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#is_file">is_file</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#json_data_reader">json_data_reader</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#load_data_at_path">load_data_at_path</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#load_json_data_at_path">load_json_data_at_path</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#makeDir">makeDir</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#make_parent_locus_dirs">make_parent_locus_dirs</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#make_parent_opfs_dirs">make_parent_opfs_dirs</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#make_parent_user_dirs">make_parent_user_dirs</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#mkdirs">mkdirs</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#move">move</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#outputFile">outputFile</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#outputJson">outputJson</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#output_append_string">output_append_string</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#output_json">output_json</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#output_string">output_string</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#readJson">readJson</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#schedule_user_dir_request">schedule_user_dir_request</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#verifyPermission">verifyPermission</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#wait_initialization">wait_initialization</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#watch">watch</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#write_append_string">write_append_string</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#write_out_json">write_out_json</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWeb.html#write_out_string">write_out_string</a></li></ul></li><li><a href="FileOperationsWebSync.html">FileOperationsWebSync</a><ul class='methods'><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#close_sync">close_sync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#copySync">copySync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#get_sync_readable">get_sync_readable</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#get_sync_writeable">get_sync_writeable</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#outputFileSync">outputFileSync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#outputJsonSync">outputJsonSync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#pathExists">pathExists</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#readFileSync">readFileSync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#readJsonSync">readJsonSync</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#sync_read">sync_read</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#sync_read_at_path">sync_read_at_path</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#sync_write">sync_write</a></li><li data-type='method' style='display: none;'><a href="FileOperationsWebSync.html#sync_write_at_path">sync_write_at_path</a></li></ul></li><li><a href="PathManager.html">PathManager</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PathManager.html#add_abbreviation">add_abbreviation</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#compile_one_path">compile_one_path</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#compile_paths">compile_paths</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#default_realtive_asset_dir">default_realtive_asset_dir</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#extract_abbreviations">extract_abbreviations</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#extract_delimited">extract_delimited</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#extract_vars">extract_vars</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#get_var">get_var</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#path_abreviations">path_abreviations</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#path_vars">path_vars</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#pop_dir">pop_dir</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#set_var">set_var</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#subst_vars">subst_vars</a></li><li data-type='method' style='display: none;'><a href="PathManager.html#translate_marker">translate_marker</a></li></ul></li></ul>
                    
    
</nav>

<div id="main">
    
    <h1 class="page-title">lib/path_extension.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
const path = require('path')
const untildify = require('untildify').default

const crypto = require('crypto')

function hash_it(path_tmpl) {
    let output = crypto.hash("sha1",path_tmpl)
    return output
}

/**
 * 
 * Fields of Conf:
 * 
 * * path_abreviations -- these are use to compile path names to relative and obsolute paths.
 * 
 * This module mix the node.js path module with class instances.
 * 
 */

class PathManager {

    /**
     * constructor
     * 
     * Initializes path abbreviations to an empty object for mapping.
     * 
     * This uses the JavaScript object rather than the map class 
     * 
     * @param {object} conf 
     */
    constructor(conf) {
        //
        this._path_abreviations = {}
        //
        Object.assign(this,path)
        if ( typeof conf === 'object' ) {
            if ( typeof conf.path_abreviations === 'object' ) {
                this._path_abreviations = Object.assign({},conf.path_abreviations)
                if ( typeof conf.vars === 'object' ) {
                    this._vars = Object.assign({},conf.vars)
                    this.compile_paths(this._path_abreviations,this._vars)
                } else {
                    this.compile_paths(this._path_abreviations)
                }
            }
        }
        //
    }

    /**
     * path_abreviations
     * 
     * This returns the abbreviations in the state that they are in. 
     * If the application has not made path_abbreviations and vars available to the 
     * constructor via conf, the configuration object, then the map will still have
     * its initial form or be empty. 
     * 
     * Otherwise, assuming no errors in compilation, the fully resolved paths will be returns 
     * as the values of the map, where a path abbreviation is the key.
     * 
     * @returns object -- the final path resulotion map after compilation
     */
    path_abreviations() {
        return this._path_abreviations
    }

    /**
     * path_vars
     * 
     * Returns the map of variable to values
     * 
     * @returns object
     */

    path_vars() {
        return this._vars
    }


    get_path(abbreviation) {
        if ( typeof abbreviation === "string" ) {
            return this._path_abreviations[abbreviation]
        }
        return undefined
    }

    /**
     * set_var
     * 
     * updates or adds a key,value pair to the variables
     * And, ths variable will be usable in ensuing evaluations
     * 
     * @param {string} a_var 
     * @param {string} a_val 
     */
    set_var(a_var,a_val) {
        if ( ( typeof a_var === "string" ) &amp;&amp; ( typeof a_val === "string" ) ) {
            this._vars[a_var] = a_val
        }
    }


    /** 
     * get_var
     * 
     * returns the string mapped by the variable or else it returns undefined
     * 
     * @return string
    */
    get_var(a_var) {
        if ( typeof a_var === "string" ) {
            return this._vars[a_var]
        }
        return undefined
    }


    /**
     * pop_dir
     * 
     * one directory higher up
     * 
     * @param {string} where_am_i 
     * @returns string
     */
    pop_dir(where_am_i) {
        let sep = path.sep
        let last_dir = where_am_i.lastIndexOf(sep)
        if ( last_dir > 0 ) {
            where_am_i = where_am_i.substring(0,last_dir)
        }
        return where_am_i
    }


    /**
     * default_realtive_asset_dir
     * 
     * one directory up from the module lib director
     * returns this location as a string
     * 
     * @returns string
     */
    default_realtive_asset_dir() {
        let where_am_i = __dirname
        let default_dir = this.pop_dir(where_am_i)
        return default_dir
    }


    /**
     * translate_marker
     * 
     * This is basically just substitution, 
     * but it looks at the path of the string that is being cleaned up.
     * 
     * Puts abbreviations mapped values in place of abbreviations, otherwise it 
     * figures an absolute path.
     * 
     * If a marker is replaced with a string containing markers, this method will recurse.
     * To avoid infinite recursion, the map and the data have to be safe. This does not 
     * track inifite recurskon. 
     * 
     * If the clean key is the string 'default', this will return the working directory.
     * 
     * 
     * @param {string} clean_key
     * 
     * @returns string
     */
    translate_marker(clean_key) {
        if ( clean_key === "default" ) {
            clean_key = this.default_realtive_asset_dir()
        } else {
            let syntax_boundary = clean_key.indexOf(']')
            if ( syntax_boundary > 0 ) {
                let location_marker = clean_key.substring(0,syntax_boundary+1)
                let findable = this._path_abreviations[location_marker]
                if ( findable ) {
                    clean_key = clean_key.replace(location_marker,findable).trim()
                    if ( clean_key[0] === '[' ) {
                        clean_key = this.translate_marker(clean_key)
                    } else if ( clean_key[0] === '~' ) {
                        clean_key = untildify(clean_key)
                    } else if ( clean_key[0] === '.' ) {
                        clean_key = path.resolve(clean_key)
                    }
                }
            }
        }
        return clean_key
    }


    /**
     * extract_delimited
     * 
     * Returns a list of variables found in the input with the delimiters affixed to their content.
     * That is, the delimiters.prefix and suffix will start and end a set of characters
     * which can be used as an identifier in some programming language or other.
     * 
     * For example: a string such as "This is ${some} test or ${other}" will result in ["${some}", "${other}"]
     * where `del` is '${' and stopper is '}'.
     * 
     * Another example:  a string such as "This is [some] test or [other]" ]will result in ["[some]", "[other]"]
     * where `del` is '[' and stopper is ']'.
     * 
     * @param {string} str 
     * @param {string} del 
     * @param {string} stopper 
     * @returns Array
     */
    extract_delimited(str,del,stopper) {
        let vset = new Set()

        let n = str.length
        for ( let i = 0; i &lt; n; i++ ) {
            let c = str[i]
            if ( c == del[0] &amp;&amp; (del.length === 2 ? str[i+1] === del[1] : true) ) {
                if( del.length === 2 ) { i++ }
                let a_var = del
                while ( i &lt; n ) {
                    i++
                    let c = str[i]
                    if ( (c !== ' ') &amp;&amp; ( c !== '\t' ) ) {
                        a_var += c
                    }
                    if ( c === stopper ) break;
                }
                a_var = a_var.trim()
                try {
                    vset.add(a_var)
                } catch(e) {}
            }
        }

        let vars  = [ ... vset ]
        return vars
    }

 
    /**
     * extract_vars
     * 
     * @param {string} str 
     * 
     * @returns Array
     */
    extract_vars(str) {
        return this.extract_delimited(str,'${','}')
    }


    /**
     * extract_abbreviations
     * @param {string} str 
     * @returns Array
     */
    extract_abbreviations(str) {
        return this.extract_delimited(str,'[',']')
    }


    /**
     * subst_vars
     * 
     * @param {string} str 
     * @param {object} subr_vars 
     * @param {object} vars_values 
     * @returns string
     */
    subst_vars(str,subr_vars,vars_values) {
        //
        let fails = 0
        for ( let a_var of subr_vars ) {
            let val = vars_values[a_var]
            if ( val !== undefined ) {
                while ( str.indexOf(a_var) >= 0 ) {
                    str = str.replace(a_var,val)
                }
            } else fails++
        }
        //
        return [str,fails]
    }

    /**
     * compile_paths
     * 
     * 
     * Example input
     * 
```
let path_abreviations = {
    "[websites]" : "[alphas]/websites",
    "[alphas]" : "[github]/alphas",
    "[alpha-copious]" : "[github]/alphas/alpha-copious",
    "[github]" : "~/Documents/GitHub",
    "[locals]" : "./stuff/[friends]",
    "[sibling]" : "../something",
    "[aunt]" : "../../${aunt}",
    "[uncle]" : "../../${uncle}",
    "[redef]" : "/home/buddies/",
    "[tricky]" : "[redef]/[aunt]/specials"
}

let vars = {
    "${aunt}" : "tia maria",
    "${uncle}" : "tio bolo"
}

Compile_paths(pobj,vars)


```
     * 
     * @param {object} pobj
     * 
     * @returns boolean
     */

    compile_paths(pobj,subs) {

        //
        let path_abreviations = pobj
        //
        let vars = subs 
        if ( ( vars !== undefined ) &amp;&amp; ( typeof pobj.vars === "object" ) ) {
            vars = pobj.vars
        }

        let abbrevs = Object.keys(path_abreviations)

        if ( vars ) {
            for ( let abrv of abbrevs ) {
                let subr = path_abreviations[abrv]
                if ( subr.indexOf("$") >= 0 ) {
                    let i = 0;
                    while ( (i &lt; 20) &amp;&amp; (subr.indexOf("$") >= 0) ) {
                        i++;
                        let subr_vars = this.extract_vars(subr)
                        let subr_o = this.subst_vars(subr,subr_vars,vars)
                        subr = subr_o[0]
                    }
                }
                path_abreviations[abrv] = subr
            }
        }

        let dble_dot = {}
        for ( let abrv of abbrevs ) {
            let subr = path_abreviations[abrv]
            //
            if ( subr.substring(0,2)  === '..' ) {
                dble_dot[abrv] = subr
            }
            //
        }
        //
        for ( let abrv of abbrevs ) {
            let subr = path_abreviations[abrv]
            //
            if ( subr.indexOf("[") >= 0 ) {
                let subr_abbrevs = this.extract_abbreviations(subr)
                let subr_o = this.subst_vars(subr,subr_abbrevs,dble_dot)
                subr = subr_o[0]
            }
            //
            path_abreviations[abrv] = subr.trim()
        }



        // now dots and tildas

        for ( let abrv of abbrevs ) {
            //
            let subr = path_abreviations[abrv]

            if ( subr[0] === '.' ) {  // relative path
                subr = path.resolve(subr)
            } else if ( subr[0] === '~' ) {
                subr = untildify(subr)
            }

            path_abreviations[abrv] = subr
            //
        }


        // ---- ---- ---- ---- ---- ---- ----
        //
        let expander_count = 0
        do {
            //
            expander_count = 0
            //
            for ( let abrv of abbrevs ) {
                let subr = path_abreviations[abrv]
                //
                if ( subr.indexOf("[") >= 0 ) {
                    let subr_abbrevs = this.extract_abbreviations(subr)
                    let subr_o = this.subst_vars(subr,subr_abbrevs,path_abreviations)
                    subr = subr_o[0]
                    let fails = subr_o[1]
                    if ( fails ) {
                        expander_count -= fails
                    }
                }
                //
                path_abreviations[abrv] = subr.trim()
                //
                if ( subr.indexOf("[") >= 0 ) {
                    expander_count++
                }
                //
            }
            //
        } while ( expander_count > 0 )


        for ( let abrv of abbrevs ) {
            let subr = path_abreviations[abrv]

            if ( subr.indexOf('..') > 0 ) {
                path_abreviations[abrv] = path.resolve(subr)
            }
        }

        return true
    }

    /**
     * compile_one_path
     * 
     * For applications that need it,
     * at any time after the orginal map has been compiled, a string with abbreviations and variabls in it 
     * can be compiled to an absolute path.
     * 
     * This method returns the compiled string and does not save the string as a map from any abbreviation to the string.
     * 
     * @param {string} path_tmpl 
     * @returns string
     */
    compile_one_path(path_tmpl) {
        let key = hash_it(path_tmpl)
        let pobj = Object.assign({},this._path_abreviations)
        let subs = Object.assign(this._vars)

        pobj[key] = path_tmpl

        this.compile_paths(pobj,subs)

        let result = pobj[key]
        result = path.resolve(result)
        //        
        return result
    }



    /**
     * add_abbreviation
     * 
     * Add an abbreviation to the paths in whatever state they are in.
     * Compile all the paths with the new abbreviation 
     * and the current set of variables
     * 
     * @param {string} abbreviation 
     * @param {string} path_template 
     */
    add_abbreviation(abbreviation,path_template) {
        if ( (typeof abbreviation === "string") &amp;&amp; (typeof path_template === "string") ) {
            this._path_abreviations[abbreviation] = path_template
            this.compile_paths(this._path_abreviations,this._vars)
        }
    }




    // prefilter
    // globs

}




module.exports = PathManager</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a> on Wed Nov 12 2025 14:07:45 GMT-0800 (Pacific Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>


<script src="scripts/collapse.js" defer></script>


</body>
</html>
